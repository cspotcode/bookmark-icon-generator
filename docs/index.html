<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Favicon Bookmarklet Generator</title>
    <script src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    <script type="module">
        const { useState, useRef } = React;

        const AlertIcon = () => React.createElement(
            "svg",
            { 
                xmlns: "http://www.w3.org/2000/svg", 
                width: "24", 
                height: "24", 
                viewBox: "0 0 24 24", 
                fill: "none", 
                stroke: "currentColor", 
                strokeWidth: "2", 
                strokeLinecap: "round", 
                strokeLinejoin: "round" 
            },
            React.createElement("circle", { cx: "12", cy: "12", r: "10" }),
            React.createElement("line", { x1: "12", y1: "8", x2: "12", y2: "12" }),
            React.createElement("line", { x1: "12", y1: "16", x2: "12.01", y2: "16" })
        );

        const Alert = ({ children, variant = "default", className, ...props }) => {
            return React.createElement("div", {
                role: "alert",
                className: `rounded-lg border p-4 ${
                    variant === "destructive"
                        ? "border-red-500 bg-red-50 text-red-700"
                        : "border-gray-200 bg-white text-gray-950"
                } ${className}`,
                ...props
            }, children);
        };

        const AlertTitle = ({ className, ...props }) => 
            React.createElement("h5", {
                className: `mb-1 font-medium leading-none tracking-tight ${className}`,
                ...props
            });

        const AlertDescription = ({ className, ...props }) => 
            React.createElement("div", {
                className: `text-sm [&_p]:leading-relaxed ${className}`,
                ...props
            });

        const FaviconBookmarkletGenerator = () => {
            const [imageFile, setImageFile] = useState(null);
            const [bookmarkletUrl, setBookmarkletUrl] = useState('');
            const [error, setError] = useState('');
            const [previewUrl, setPreviewUrl] = useState('');
            const pasteAreaRef = useRef(null);

            const handleFileChange = (event) => {
                const file = event.target.files[0];
                handleImageInput(file);
            };

            const handleImageInput = (file) => {
                if (file && file.type.startsWith('image/')) {
                    setImageFile(file);
                    setError('');
                    const reader = new FileReader();
                    reader.onload = (e) => setPreviewUrl(e.target.result);
                    reader.readAsDataURL(file);
                } else {
                    setError('Please select a valid image file.');
                    setImageFile(null);
                    setPreviewUrl('');
                }
            };

            const handlePaste = (event) => {
                const items = event.clipboardData.items;
                for (let i = 0; i < items.length; i++) {
                    if (items[i].type.indexOf('image') !== -1) {
                        const file = items[i].getAsFile();
                        handleImageInput(file);
                        break;
                    }
                }
            };

            const generateBookmarklet = async () => {
                if (!imageFile) {
                    setError('Please select or paste an image first.');
                    return;
                }

                try {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const base64Data = e.target.result;
                        const htmlContent = `
                            <html>
                                <head>
                                    <title></title>
                                    <link rel="icon" href="${base64Data}">
                                </head>
                                <body>
                                    <!-- Empty body for minimal bookmark -->
                                </body>
                            </html>
                        `;
                        const dataUrl = `data:text/html;charset=utf-8,${encodeURIComponent(htmlContent)}`;
                        setBookmarkletUrl(dataUrl);
                    };
                    reader.readAsDataURL(imageFile);
                } catch (err) {
                    setError('An error occurred while generating the bookmarklet.');
                    console.error(err);
                }
            };

            return React.createElement(
                "div",
                { className: "p-4 max-w-md mx-auto" },
                React.createElement("h1", { className: "text-2xl font-bold mb-4" }, "Favicon Bookmarklet Generator"),
                React.createElement(
                    "div",
                    {
                        ref: pasteAreaRef,
                        onPaste: handlePaste,
                        className: "mb-4 p-4 border-2 border-dashed rounded text-center cursor-pointer",
                        onClick: () => pasteAreaRef.current.focus(),
                        tabIndex: "0"
                    },
                    "Click here and paste your image, or drag and drop"
                ),
                React.createElement("input", {
                    type: "file",
                    accept: "image/*",
                    onChange: handleFileChange,
                    className: "mb-4 p-2 border rounded w-full"
                }),
                previewUrl && React.createElement("img", { src: previewUrl, alt: "Preview", className: "mb-4 max-w-full h-auto" }),
                React.createElement(
                    "button",
                    {
                        onClick: generateBookmarklet,
                        className: "bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 w-full mb-4"
                    },
                    "Generate Bookmarklet"
                ),
                error && React.createElement(
                    Alert,
                    { variant: "destructive", className: "mb-4" },
                    React.createElement(AlertIcon),
                    React.createElement(AlertTitle, null, "Error"),
                    React.createElement(AlertDescription, null, error)
                ),
                bookmarkletUrl && React.createElement(
                    "div",
                    { className: "mt-4" },
                    React.createElement("p", { className: "mb-2" }, "Your bookmarklet is ready! Drag this link to your bookmarks bar:"),
                    React.createElement(
                        "a",
                        {
                            href: bookmarkletUrl,
                            className: "bg-green-500 text-white px-4 py-2 rounded inline-block hover:bg-green-600"
                        },
                        "\u2800"
                    )
                )
            );
        };

        ReactDOM.render(React.createElement(FaviconBookmarkletGenerator), document.getElementById('root'));
    </script>
</body>
</html>
